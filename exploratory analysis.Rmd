---
title: "exploratory_analysis"
author: "Anand Rajan"
date: "12/5/2021"
output: html_document

---

```{r setup, include=FALSE}
library(tidyverse)
library(readxl)
library(rvest)
library(httr)
library(wesanderson)
library(viridis)

        
knitr::opts_chunk$set(echo = TRUE)
```

## Exploring Death Rate Data set

### Lung Cancer Death Rate
```{r}
lung_cancer_death_rate =
death_state %>%  
  select(state, lung_and_bronchus_female,lung_and_bronchus_male, lung_and_bronchus_both_sexes_combined) %>% 
  knitr::kable()

death_state %>%  
  select(state, all_cancer_types_combined_both_sexes_combined) %>% 
  knitr::kable()

death_state %>% 
  select(state, all_cancer_types_combined_both_sexes_combined) %>% 
  ggplot(aes(x=state, y=all_cancer_types_combined_both_sexes_combined)) +
   theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1)) +
    geom_point()
  
  
```

Visualizations 
```{r}

death_state %>% 
  select(state, lung_and_bronchus_both_sexes_combined) %>% 
  ggplot(aes(x=state, y=lung_and_bronchus_both_sexes_combined)) +
  geom_point()

```

Exploring Pollution dataset


```{r}

pollution %>% 
  select(-c("month")) %>% 
  group_by(year,state)

pollution %>% 
  group_by(state) %>% 
  pull(state)

```

Pollution Trends Nationwide

```{r}
no2_trend = 
modified_pollution %>% 
  ggplot(aes(x=year,y=no2_mean)) +
  geom_point() +
  geom_smooth(se=FALSE) +
  scale_color_viridis(discrete=FALSE) +
  theme_bw()  +
  labs(
    title="Nationwide Trend in Nitrous Dioxide Concentration from 2000-2016",
    x="Year",
    y="Nitrous Oxide Concentration(ppm)"
  )
  
```

```{r}
nationwide_so2trend=
  modified_pollution %>% 
  ggplot(aes(x=year,y=so2_mean)) + 
  geom_point(alpha=0.3) +
  geom_smooth(se=FALSE) +
  scale_color_viridis(discrete=FALSE) +
  theme_bw() +
  labs(
    title="Nationwide Trend in Sulfur Dioxide Concentration from 2000-2016",
    x="Year",
    y="Sulfur Oxide Concentration(ppm)"
  )
```


```{r}
nationwide_o3trend=
  modified_pollution %>% 
  ggplot(aes(x=year,y=o3_mean)) + 
  geom_point() +
  labs(
    title="Nationwide Trend in Ozone Concentration from 2000-2016",
    x="Year",
    y="Ozone Concentration(ppm)"
  )
```

```{r}
  modified_pollution %>% 
  ggplot(aes(x=year,y=co_mean)) + 
  geom_point() +
  geom_smooth(se=FALSE) +
  labs(
    title="Nationwide Trend in Carbon Monoxide Concentration from 2000-2016",
    x="Year",
    y="Carbon Monoxide Concentration(ppm)"
  )
```


```{r}
pollution %>% 
  select(-o3_mean,-so2_mean,-co_mean) %>% 
  group_by(state,year) %>% 
  filter(state == "New York") %>% 
  ggplot(aes(x= month, y=no2_mean, group=year, color=year)) +
  geom_point(alpha=0.5) +
  geom_line() +
  labs(title="Nitrous Dioxide Pollutant Concentration over Time In New York")

pollution %>% 
  filter(
    year %in% c("2013","2014","2015","2016")
  ) %>% 
  ggplot(aes(x= year, y=no2_mean, group=state, color=state)) +
  geom_point(alpha=0.5) +
  geom_line()

```

```{r}
pollution %>% 
  filter(
    year %in% c("2013","2014","2015","2016")
  ) %>% 
  ggplot(aes(x= year, y=so2_mean, group=state, color=state)) +
  geom_point(alpha=0.5) +
  geom_line()
```



```{r}
pollution %>% 
  filter(
    year %in% c("2013","2014","2015","2016")
  ) %>% 
  ggplot(aes(x= year, y=co_mean, group=state, color=state)) +
  geom_point(alpha=0.5) +
  geom_line()
```


```{r}
pollution %>% 
  filter(
    year %in% c("2013","2014","2015","2016")
  ) %>% 
  ggplot(aes(x= year, y=o3_mean, group=state, color=state)) +
  geom_point(alpha=0.5) +
  geom_line()
```

Creating a function to plot trends of mean pollutant concentration from 2013-2016 by state


```{r}


```

