---
title: "The Effect of Concentrations of Various Air Pollutants on Cancer Prevalence at the State Level over Time"
output: 
  html_document:
    toc: true
    toc_float: true
    code_folding: hide
---

&nbsp;


# Motivation

&nbsp;

## Background and Related Works


Given the rapid progression of climate change, we have seen widespread effects on the environment, in which long-term exposure subsequently have harmful health effects that is a cause for public health concern. Major air pollutants have serious adverse effects on population health and has been linked by substantial evidence to be a large contributor to an increased burden of cancer.

Common air pollutants are responsible for pervasive inflammation throughout the body ([NSW, 2021](https://www.health.nsw.gov.au/environment/air/Pages/outdoor-air-pollution.aspx)), and long-term exposure has been linked to increased mortality for all cancers, but particularly hazardous for cancers of the lung, liver, colorectal, bladder, kidney, and larynx ([Kim et. al, 2018](https://www.ncbi.nlm.nih.gov/pmc/articles/PMC6266691/)).

Lung cancer is the currently the leading cause of cancer-related mortality and most commonly diagnosed. Liver cancer also accounts largely for a high number of cancer-related deaths (8.2%) behind lung and breast cancer ([Turner et.al, 2020](https://acsjournals.onlinelibrary.wiley.com/doi/10.3322/caac.21632)) while overall pancreatic cancer has increased for both men and women between 2013-2017 as reported in the [2021 National Cancer Institute Annual Report to the Nation](https://seer.cancer.gov/report_to_nation/infographics/trends_incidence.html).

&nbsp;

## Project Motivations

Current research and trends clearly demonstrate that air pollution is associated with the increase in both incidence and mortality for certain cancers.  Thus, we will to take a closer look at trends of levels of major air pollutants that are of major public health concern [as declared by the WHO](https://www.who.int/health-topics/air-pollution#tab=tab_1): NO2, SO2, CO and 03, and compare these trends to incidence and mortality of lung, liver and pancreatic cancer data by state, with respect to time. 

Our motivation for this project is to more robustly investigate the aforementioned theories by further analyzing and evaluating the associations between pollutants and certain cancer types at the population level with respect to time.

The implications of such an analysis can provide justification for further research on the effects of major air pollutants on cancer survival and motivate urgency for environmental policy to slow the progression of climate change to improve quality of life and deleterious consequences on population health. 

<center>
<img src="pathways.png" style="width:75%">
</center>

<center>
Turner et.al (2020): Air Pollution-Related Cancer: Potential Pathways and Mechanisms. 
</center>

&nbsp;

# Research Questions 

Some ideas for the questions, not definite

- What is the relationship between incidence rate and mortality rate of different types of cancer?
- What has been the general trend of cancer incidence, cancer mortality, and pollution levels over time?
- What is the geographical spread of cancer incidence and pollution levels in US?
- Is there any evidence of association between cancer incidence (especially lung cancer) and air pollution?

&nbsp;

# Data 

## Data Source

Our project consists of data from two main sources: 

Regarding cancer statistics, we retrieved data from [American Cancer Society Cancer Statistics Center](https://cancerstatisticscenter.cancer.org/#!/). Raw data sets were available for download in excel format. The three data sets give us information on aggregated mortality and incidence rates from 2013 to 2017, aggregated mortality and incidence rates of various cancers at the state level from 2013 to 2017, and trends of mortality related to various cancers over time from 1930 to 2018. According to the file and website, the data source is the North American Association of Central Cancer registries. 

### *Cancer Data Code:*

Average annual rate per 100,000, age adjusted to the 2000 US standard population.

Incidence/Death Rate Per Cancer Type:

- `Cancer Type` : Type of cancer
- `Both sexes combined` : Combined rate for both female and male
- `Female` : Rate for female only
- `Male` : Rate for male only

Incidence/Death Rate Per State:

- `State` : US States including `All U.S. combined` as an observation

- Following columns for each cancer types:

  - `Both sexes combined`
  - `Female`
  - `Male`



The second data set is air pollution data in the United States from 2000 to 2016. The data was gathered by the EPA and measures air pollutant concentrations(in ppb/ppm) for major pollutants at the city/county level. This is an extremely large data set with over 174,000 observations.
[Brief description of the pollution data set](https://data.world/data-society/us-air-pollution-data)

We focused our analyses on the mean values of 4 major pollutants:

- **Nitrogen Dioxide (NO2)** : measured in parts per billion
- **Sulphur Dioxide (SO2)** : measured in parts per billion
- **Carbon Monoxide (CO)** : measured in parts per million
- **Ozone (O3)** : measured in parts per million

### *Pollution Data Code:*

- `State Code `: The code allocated by US EPA to each state
- `County code` : The code of counties in a specific state allocated by US EPA
- `Site Num` : The site number in a specific county allocated by US EPA
- `Address`: Address of the monitoring site
- `State` : State of monitoring site
- `County` : County of monitoring site
- `City` : City of the monitoring site
- `Date Local` : Date of monitoring

- Following Columns Per Each Pollutant:

  - `Units` : The units measured for pollutant
  - `Mean` : The arithmetic mean of concentration of pollutant within a given day
  - `AQI` : The calculated air quality index of pollutant within a given day
  - `1st Max Value` : The maximum value obtained for pollutant concentration in a given day
  - `1st Max Hour` : The hour when the maximum pollutant concentration was recorded in a given day


## Data Cleaning

The pollution data was available for download in a csv format which was uploaded to repo using git LFS due to its size. Then this data was cleaned to have year, state, and the mean values of the 4 pollutants as main variables. Furthermore, observations from `Country of Mexico` was excluded to match available state data from cancer mortality trend dataset. 

```{r include = FALSE}
library(tidyverse)
library(readxl)
knitr::opts_chunk$set(warning = FALSE, message = FALSE) 
```

```{r pollution data cleaning example}
pollution = read_csv("data/uspollution_us_2000_2016.csv") %>% 
  janitor::clean_names() %>%
  select(state, date_local, no2_mean, o3_mean, 
         so2_mean, co_mean) %>%
  separate(date_local, into = c("year", "month", "day"), sep = "\\-") %>%
  select(-c("month", "day")) %>%
  group_by(year, state) %>%
  summarize(across(everything(), mean)) %>%
  mutate_if(is.numeric, ~round(., 3)) %>%
  filter(state != "Country Of Mexico") %>% 
  mutate(
    year = as.numeric(year)
  )
```


Additionally, to explore the relationship among different pollutant levels and cancer incidence, especially lung cancer, another version of pollution data aggregated to have mean pollutant levels from 2013 to 2017 collectively was prepared.

```{r pollution 2013-2017 cleaning example}
pollution1 =
  pollution %>% 
  filter(
    year %in% (2013:2017)
  ) %>% 
  ungroup() %>% 
  select(state:co_mean) %>% 
  group_by(state) %>% 
  summarize(
    no2 = mean(no2_mean),
    o3 = mean(o3_mean),
    so2 = mean(so2_mean),
    co = mean(co_mean)
  ) %>%
  mutate_if(is.numeric, ~round(., 3))
```


All cancer related data from the Cancer Statistics Center were all available in excel format for download. In order to match the time period of the pollution data containing observations from 2000 to 2016, the mortality trend data was cleaned to have observations from 2000 to 2016 only as well. Moreover, our function `remove_note` allowed cleaning observation points with notes added to only have the numeric value.

```{r death trend data cleaning example}
read_death_time =
  read_excel("data/DeathTrend.xlsx", 
             skip = 6) %>%
  janitor::clean_names()

x = c("colorectum_female", "colorectum_male", "liver_and_intrahepatic_bile_duct_female", "liver_and_intrahepatic_bile_duct_male", "lung_and_bronchus_female", "lung_and_bronchus_male", "ovary_female", "uterus_cervix_and_corpus_combined_female")

remove_note = function(column_name) {
  read_death_time = read_death_time %>% 
    separate(column_name, into = c(column_name, "note"), sep = "\\-") %>% 
    select(-note)}

for (i in x) {
  read_death_time = remove_note(i)} 

death_time =
  read_death_time %>%
  filter(year %in% 2000:2016) %>%
  select(-c("breast_male", "ovary_male", "prostate_female","uterus_cervix_and_corpus_combined_male")) %>%
  mutate_at(vars(-("year")), as.numeric) %>%
  mutate(year = as.factor(year))
  
```

Cancer incidence and mortality datasets per state and per cancer types were similarly cleaned to have only the numeric observation values. More specifically for data per cancer type, the incidence rates for the `Colon (excluding rectum)` and `Rectum` were excluded to match similarly formatted death rate per cancer type dataset. Also, observations for `Puerto Rico` were excluded from incidence and death rate per state dataset to match the state variable available in the pollution dataset. 

```{r inc per cancer type and per state data cleaning example}
inc_cancer =
  read_excel("data/IncRate.xlsx", sheet = "All US", 
             skip = 6) %>%
  janitor::clean_names() %>% 
  mutate(
    male = if_else(male == "n/a", "0", male),
    female = if_else(female == "n/a", "0", female)
  ) %>%
  separate(both_sexes_combined, into = c("both_sexes_combined", "note"), sep = "\\-") %>%
  select(-note) %>%
  mutate_at(vars(-("cancer_type")), as.numeric) %>%
  filter(cancer_type != "Colon (excluding rectum)",
         cancer_type != "Rectum")

inc_state =
  read_excel("data/IncRate.xlsx", sheet = "State", 
             skip = 6) %>%
  janitor::clean_names() %>% 
  separate(
    col = breast_both_sexes_combined,
    into = c("breast_total", "female_breast_only"),
    sep = "-"
  ) %>% 
  mutate(
    breast_male = if_else(breast_male == "n/a", "0", breast_male),
    cervix_male = if_else(cervix_male == "n/a", "0", cervix_male),
    colon_excluding_rectum_both_sexes_combined = if_else(colon_excluding_rectum_both_sexes_combined == "n/a", "0", colon_excluding_rectum_both_sexes_combined),
    colon_excluding_rectum_female = if_else(colon_excluding_rectum_female == "n/a", "0", colon_excluding_rectum_female),
    colon_excluding_rectum_male = if_else(colon_excluding_rectum_male == "n/a", "0", colon_excluding_rectum_male),
  ) %>%
  filter(state != "Puerto Rico") %>%
  select(-c("female_breast_only", starts_with("colon"), starts_with("rectum")))
```

&nbsp;

# Exploratory Analysis

For visual plots, check out [Exploratory Analysis](exploratory-analysis.html)!

To explore 

&nbsp;

# Regression Analysis

&nbsp;

# Discussion

In light of our exploratory and regressed analysis, we attained the following insights:


## Limitations and Challenges






